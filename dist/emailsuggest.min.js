(function(a){a.fn.emailsuggest=function(b){var c=a(this);this.on("change keyup copy paste cut",function(j){if(j.keyCode!==40&&j.keyCode!==38&&j.keyCode!==13){if(c.val().length>0){var f={};var d=a(this).val().replace(/\s/g,"").split(",");a.each(d,function(i,e){if(i+1===d.length){a.each(b.emails,function(k,l){if(l.toLowerCase().search(e.toLowerCase())!==-1){f[l]=l}});a.each(b.names,function(k,l){a.each(l,function(n,m){if(n.toLowerCase().search(e.toLowerCase())!==-1||m.toLowerCase().search(e.toLowerCase())!==-1){f[n]=m}})})}});if(c.next().is(".es_list")){c.next(".es_list").html("")}else{c.after('<div class="es_list"></div>')}a.each(f,function(i,e){c.next(".es_list").append("<div>"+i+" <span>"+e+"</span></div>").children("div:nth-child(1)").addClass("on")})}else{c.next(".es_list").remove()}}else{if(j.keyCode===13){j.preventDefault();if(c.next().is(".es_list")){var g=c.val();if(c.next(".es_list").children().length===1){if(g.search(",")!==-1){c.val(g.substr(0,g.lastIndexOf(","))+", "+c.next(".es_list").children("div").children("span").html())}else{c.val(c.next(".es_list").children("div").children("span").html())}}else{if(c.next(".es_list").children(".on")){if(g.search(",")!==-1){c.val(g.substr(0,g.lastIndexOf(","))+", "+c.next(".es_list").children(".on").children("span").html())}else{c.val(c.next(".es_list").children(".on").children("span").html())}}}c.focus();c.next(".es_list").remove()}}else{if(j.keyCode===40||j.keyCode===38){j.preventDefault();var h=c.next(".es_list").children(".on").index()>=0?c.next(".es_list").children(".on").index()+1:c.next(".es_list").children(".on").index();if(j.keyCode===40){c.next(".es_list").children("div:nth-child("+h+")").removeClass("on").next().addClass("on")}else{if(j.keyCode===38){c.next(".es_list").children("div:nth-child("+h+")").removeClass("on").prev().addClass("on")}}}}}})}}(jQuery));